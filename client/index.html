<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />

    <!-- SEO Meta Tags -->
    <title>ColÃ©gio OSE - TradiÃ§Ã£o Secular de Ensino em Sorocaba | Desde 1924</title>
    <meta name="description" content="ColÃ©gio OSE - 100 anos de excelÃªncia educacional em Sorocaba. EducaÃ§Ã£o Infantil, Ensino Fundamental e MÃ©dio. Formando lÃ­deres conscientes desde 1924." />
    <meta name="keywords" content="colÃ©gio OSE, escola Sorocaba, educaÃ§Ã£o infantil, ensino fundamental, ensino mÃ©dio, escola particular Sorocaba, OSE" />
    <meta name="author" content="ColÃ©gio OSE" />
    <meta name="robots" content="index, follow" />
    <link rel="canonical" href="https://colegioose.com.br/" />

    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="ColÃ©gio OSE - TradiÃ§Ã£o Secular de Ensino em Sorocaba" />
    <meta property="og:description" content="100 anos de excelÃªncia educacional em Sorocaba. EducaÃ§Ã£o Infantil, Ensino Fundamental e MÃ©dio. Formando lÃ­deres conscientes desde 1924." />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://colegioose.com.br/" />
    <meta property="og:image" content="https://colegioose.com.br/images/logo-ose.png" />
    <meta property="og:site_name" content="ColÃ©gio OSE" />
    <meta property="og:locale" content="pt_BR" />

    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="ColÃ©gio OSE - TradiÃ§Ã£o Secular de Ensino em Sorocaba" />
    <meta name="twitter:description" content="100 anos de excelÃªncia educacional em Sorocaba. EducaÃ§Ã£o Infantil, Ensino Fundamental e MÃ©dio." />
    <meta name="twitter:image" content="https://colegioose.com.br/images/logo-ose.png" />

    <!-- DNS Prefetch for Performance -->
    <link rel="dns-prefetch" href="//www.googletagmanager.com">
    <link rel="dns-prefetch" href="//www.google-analytics.com">
    <link rel="dns-prefetch" href="//connect.facebook.net">
    <link rel="dns-prefetch" href="//fonts.googleapis.com">
    <link rel="dns-prefetch" href="//fonts.gstatic.com">

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="shortcut icon" href="/favicon.ico" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#D97706" />
    <link rel="manifest" href="/site.webmanifest" />
    <meta name="theme-color" content="#D97706" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="format-detection" content="telephone=no" />

    <meta http-equiv="Content-Security-Policy" content="
      default-src 'self';
      script-src 'self' 'unsafe-inline' 'unsafe-eval' 
        https://www.googletagmanager.com 
        https://www.google-analytics.com 
        https://connect.facebook.net 
        https://sdk.dfktv2.com 
        https://www.uchat.com.au
        https://replit.com
        https://googleads.g.doubleclick.net
        https://www.googleadservices.com
        https://ipapi.co;
      style-src 'self' 'unsafe-inline' 
        https://fonts.googleapis.com 
        https://sdk.dfktv2.com 
        https://www.uchat.com.au;
      font-src 'self' 
        https://fonts.gstatic.com 
        https://sdk.dfktv2.com 
        https://www.uchat.com.au;
      img-src 'self' data: blob: 
        https://www.google-analytics.com 
        https://www.googletagmanager.com 
        https://www.facebook.com 
        https://connect.facebook.net 
        https://sdk.dfktv2.com 
        https://www.uchat.com.au
        https://googleads.g.doubleclick.net
        https://www.googleadservices.com;
      connect-src 'self' 
        https://www.google-analytics.com 
        https://analytics.google.com 
        https://www.googletagmanager.com 
        https://www.facebook.com 
        https://connect.facebook.net 
        https://sdk.dfktv2.com 
        https://www.uchat.com.au
        https://googleads.g.doubleclick.net
        https://www.googleadservices.com
        https://ipapi.co;
      frame-src 'self' 
        https://www.youtube.com 
        https://www.google.com 
        https://calendly.com 
        https://www.uchat.com.au 
        https://sdk.dfktv2.com
        https://www.googletagmanager.com
        https://td.doubleclick.net
        https://googleads.g.doubleclick.net;
      media-src 'self' 
        https://sdk.dfktv2.com 
        https://www.uchat.com.au;
    ">

    <!-- UChatWidget Global Installation - Sempre presente -->
    <script>
      (function() {
        let retryCount = 0;
        const maxRetries = 3;
        let widgetCheckInterval;

        // Enhanced widget detection
        function findUChatWidget() {
          const selectors = [
            '[id*="uchat"]',
            '[class*="uchat"]',
            '[id*="chat"]',
            '[class*="chat"]',
            '.uchat-widget',
            '#uchat-widget',
            'iframe[src*="uchat"]',
            'iframe[src*="widget"]',
            'div[data-uchat]',
            '[data-widget-id]'
          ];

          for (let selector of selectors) {
            const elements = document.querySelectorAll(selector);
            if (elements.length > 0) {
              return Array.from(elements);
            }
          }
          return [];
        }

        // Force widget visibility
        function forceWidgetVisibility(widgets) {
          widgets.forEach(widget => {
            if (widget instanceof HTMLElement) {
              widget.style.display = 'block !important';
              widget.style.visibility = 'visible !important';
              widget.style.opacity = '1 !important';
              widget.style.zIndex = '999999';
              widget.style.position = 'fixed';
              console.log('UChatWidget forced visible:', widget);
            }
          });
        }

        // Check widget periodically
        function checkWidgetPeriodically() {
          widgetCheckInterval = setInterval(function() {
            const widgets = findUChatWidget();
            if (widgets.length > 0) {
              console.log('UChatWidget widget found in DOM');
              forceWidgetVisibility(widgets);
              clearInterval(widgetCheckInterval);
            } else {
              console.log('UChatWidget still not found, checking again...');
            }
          }, 2000);

          // Stop checking after 30 seconds
          setTimeout(() => {
            if (widgetCheckInterval) {
              clearInterval(widgetCheckInterval);
              const widgets = findUChatWidget();
              if (widgets.length === 0) {
                console.warn('UChatWidget not found after 30 seconds - creating fallback');
                createFallbackWidget();
              }
            }
          }, 30000);
        }

        // Load UChatWidget with enhanced error handling and retry mechanism
        function loadUChatWidget() {
          console.log(`UChatWidget loading attempt ${retryCount + 1}/${maxRetries}`);

          var script = document.createElement('script');
          script.async = true;
          script.defer = true;
          script.src = 'https://www.uchat.com.au/js/widget/to6wv2osffcdtdwb/float.js';

          script.onload = function() {
            console.log('UChatWidget loaded successfully');

            // Start periodic checking
            checkWidgetPeriodically();

            // Force widget initialization if available
            setTimeout(function() {
              if (window.UChatWidget && typeof window.UChatWidget.init === 'function') {
                try {
                  window.UChatWidget.init();
                  console.log('UChatWidget manually initialized');
                } catch (e) {
                  console.error('Error initializing UChatWidget:', e);
                }
              }
            }, 1000);
          };

          script.onerror = function() {
            console.error(`Failed to load UChatWidget (attempt ${retryCount + 1})`);
            retryCount++;

            if (retryCount < maxRetries) {
              setTimeout(loadUChatWidget, 2000 * retryCount);
            } else {
              console.error('UChatWidget failed after all retries - creating fallback');
              createFallbackWidget();
            }
          };

          document.head.appendChild(script);
        }

        function createFallbackWidget() {
          // Remove existing fallbacks
          const existing = document.getElementById('uchat-fallback-widget');
          if (existing) existing.remove();

          const fallbackWidget = document.createElement('div');
          fallbackWidget.id = 'uchat-fallback-widget';
          fallbackWidget.innerHTML = '<a href="https://wa.me/5515021013812" target="_blank" style="position: fixed; bottom: 20px; right: 20px; background: #25D366; color: white; padding: 15px; border-radius: 50px; text-decoration: none; box-shadow: 0 4px 12px rgba(0,0,0,0.3); z-index: 999999; font-size: 16px; animation: bounce 2s infinite;">ðŸ’¬ WhatsApp</a>';
          document.body.appendChild(fallbackWidget);

          // Add bounce animation
          if (!document.getElementById('uchat-fallback-styles')) {
            const style = document.createElement('style');
            style.id = 'uchat-fallback-styles';
            style.textContent = '@keyframes bounce { 0%, 20%, 50%, 80%, 100% { transform: translateY(0); } 40% { transform: translateY(-10px); } 60% { transform: translateY(-5px); } }';
            document.head.appendChild(style);
          }

          console.log('UChatWidget fallback widget created');
        }

        // Load when DOM is ready
        if (document.readyState === 'loading') {
          document.addEventListener('DOMContentLoaded', loadUChatWidget);
        } else {
          loadUChatWidget();
        }
      })();
    </script>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
    <!-- This is a replit script which adds a banner on the top of the page when opened in development mode outside the replit environment -->
    <script type="text/javascript" src="https://replit.com/public/js/replit-dev-banner.js"></script>
  </body>
</html>